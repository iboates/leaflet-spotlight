L.Map.include({_spotlightRegistry:{},addSpotlight:function(t){this._spotlightRegistry[t.id]=t.options},removeSpotlight:function(t){this.removeLayer(this._spotlightRegistry[t.id].spotlightLayer),this.removeLayer(this._spotlightRegistry[t.id].spotlightHighlightLayer),delete this._spotlightRegistry[t.id]},hasSpotlight:function(t){return console.log(t),this._spotlightRegistry[t.id]==t.options}}),L.SpotlightHandler=L.Handler.extend({addHooks:function(){this._map.addEventListener("mousemove",this._refreshSpotlights)},_refreshSpotlights:function(t){for(var i in this._spotlightRegistry){var e=this._spotlightRegistry[i];this.hasLayer(e.spotlightHighlightLayer)&&this.removeLayer(e.spotlightHighlightLayer),this.hasLayer(e.spotlightLayer)&&this.removeLayer(e.spotlightLayer);var o=turf.pointsWithinPolygon(this._spotlightRegistry[i].targetLayer.toGeoJSON(),e.spotlightShape([t.latlng.lng,t.latlng.lat]));"circleMarker"==e.spotlightType?"function"!=typeof e.highlightStyle?e.spotlightHighlightLayer=L.geoJSON(o,{pointToLayer:function(t,i){return L.circleMarker(i,e.highlightStyle)}}).addTo(this):e.spotlightHighlightLayer=L.geoJSON(o,{pointToLayer:function(t,i){return L.circleMarker(i,e.highlightStyle(t))}}).addTo(this):"marker"==e.spotlightType&&("function"!=typeof e.markerOptions?e.spotlightHighlightLayer=L.geoJSON(o,{pointToLayer:function(t,i){return L.marker(i,e.markerOptions)}}).addTo(this):e.spotlightHighlightLayer=L.geoJSON(o,{pointToLayer:function(t,i){return L.marker(i,e.markerOptions(t))}}).addTo(this)),e.spotlightLayer=L.geoJSON(e.spotlightShape([t.latlng.lng,t.latlng.lat]),{style:e.spotlightStyle}).addTo(this)}}}),L.Map.addInitHook("addHandler","spotlight",L.SpotlightHandler),L.Spotlight=L.Class.extend({options:{spotlightType:1,highlightStyle:1,spotlightShape:1,spotlightStyle:1,markerOptions:1,targetLayer:1},initialize:function(t){this.id=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)),L.setOptions(this,t)},addTo:function(t){t.addSpotlight(this)}}),L.spotlight=function(t,i){return new L.Spotlight(t,i)};